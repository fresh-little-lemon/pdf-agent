# ğŸ“„ PDFè®ºæ–‡åˆ†æåŠ©æ‰‹ - Agentæ¶æ„

## ğŸ¯ æœ€æ–°æ›´æ–°

### ğŸ§  æ™ºèƒ½Agentæ¶æ„é‡æ„

ä¸ºäº†é™ä½ä»£ç è€¦åˆåº¦å¹¶æé«˜åŠŸèƒ½æ¨¡å—åŒ–ï¼Œæˆ‘ä»¬å°†è®ºæ–‡åˆ†æåŠŸèƒ½é‡æ„ä¸ºç‹¬ç«‹çš„Agentæ¨¡å—ï¼š

#### ğŸ“ PaperSummaryAgentï¼ˆè®ºæ–‡æ€»ç»“ä»£ç†ï¼‰
- **åŠŸèƒ½**: æ™ºèƒ½åˆ†æå’Œæ€»ç»“å­¦æœ¯è®ºæ–‡å†…å®¹
- **æ¨¡å‹**: Qwen/Qwen2.5-14B-Instruct-1M
- **ç‰¹ç‚¹**: ç»“æ„åŒ–æ€»ç»“ï¼ŒåŒ…å«æ ‡é¢˜ã€ä½œè€…ã€èƒŒæ™¯ã€æ–¹æ³•ã€è´¡çŒ®ã€ç»“æœã€ç»“è®º

#### ğŸ¤– PaperQAAgentï¼ˆæ™ºèƒ½é—®ç­”ä»£ç†ï¼‰
- **åŠŸèƒ½**: åŸºäºè®ºæ–‡å†…å®¹çš„æ™ºèƒ½é—®ç­”ç³»ç»Ÿ
- **è·¯ç”±æ¨¡å‹**: Qwen/Qwen3-235B-A22Bï¼ˆæ™ºèƒ½åˆ¤æ–­é—®é¢˜ç±»å‹ï¼‰
- **æ–‡æœ¬æ¨¡å‹**: Qwen/Qwen2.5-14B-Instruct-1Mï¼ˆçº¯æ–‡æœ¬é—®ç­”ï¼‰
- **è§†è§‰æ¨¡å‹**: Qwen/Qwen2.5-VL-72B-Instructï¼ˆå›¾åƒå†…å®¹åˆ†æï¼‰

### ğŸ”„ æ™ºèƒ½è·¯ç”±ç³»ç»Ÿ

#### è·¯ç”±é€»è¾‘
```python
# è‡ªåŠ¨åˆ¤æ–­é—®é¢˜ç±»å‹
question = "è®ºæ–‡ä¸­çš„ç¬¬äºŒå¼ å›¾ç‰‡è¯´äº†ä»€ä¹ˆï¼Ÿ"
# è·¯ç”±agentåˆ¤æ–­ â†’ éœ€è¦è§†è§‰åŠŸèƒ½
# è‡ªåŠ¨é€‰æ‹©è§†è§‰æ¨¡å‹è¿›è¡Œåˆ†æ

question = "è¿™ç¯‡è®ºæ–‡çš„ä¸»è¦è´¡çŒ®æ˜¯ä»€ä¹ˆï¼Ÿ"  
# è·¯ç”±agentåˆ¤æ–­ â†’ çº¯æ–‡æœ¬é—®é¢˜
# ä½¿ç”¨æ–‡æœ¬æ¨¡å‹è¿›è¡Œå›ç­”
```

#### æ”¯æŒçš„è§†è§‰é—®é¢˜ç±»å‹
- ğŸ“Š **å›¾è¡¨åˆ†æ**: "å›¾1æ˜¾ç¤ºäº†ä»€ä¹ˆæ•°æ®ï¼Ÿ"
- ğŸ–¼ï¸ **å›¾ç‰‡æè¿°**: "ç¬¬ä¸‰å¼ å›¾ç‰‡çš„å†…å®¹æ˜¯ä»€ä¹ˆï¼Ÿ"
- ğŸ“ˆ **è¶‹åŠ¿åˆ†æ**: "å›¾è¡¨ä¸­çš„è¶‹åŠ¿è¯´æ˜äº†ä»€ä¹ˆï¼Ÿ"
- ğŸ” **ç»†èŠ‚æŸ¥è¯¢**: "ç¤ºæ„å›¾ä¸­çš„æµç¨‹æ˜¯æ€æ ·çš„ï¼Ÿ"

## ğŸ—ï¸ æ¶æ„è¯´æ˜

### æ–‡ä»¶ç»“æ„
```
agent/
â”œâ”€â”€ __init__.py                 # Agentæ¨¡å—å…¥å£
â”œâ”€â”€ paper_summary_agent.py      # è®ºæ–‡æ€»ç»“ä»£ç†
â””â”€â”€ paper_qa_agent.py          # æ™ºèƒ½é—®ç­”ä»£ç†ï¼ˆå«è·¯ç”±ï¼‰

app.py                         # ä¸»åº”ç”¨ï¼ˆç®€åŒ–åï¼‰
```

### ğŸ§© æ¨¡å—åŒ–è®¾è®¡

#### 1. PaperSummaryAgent
```python
from agent.paper_summary_agent import PaperSummaryAgent

agent = PaperSummaryAgent(logger)
result = agent.summarize_paper(markdown_file)
```

**æ ¸å¿ƒåŠŸèƒ½**:
- âœ… Markdownå†…å®¹éªŒè¯
- ğŸ“‹ æ™ºèƒ½æç¤ºè¯ç”Ÿæˆ
- ğŸ¯ ç»“æ„åŒ–è®ºæ–‡æ€»ç»“
- ğŸ”§ é”™è¯¯å¤„ç†å’Œé‡è¯•

#### 2. PaperQAAgent
```python
from agent.paper_qa_agent import PaperQAAgent

agent = PaperQAAgent(logger)
answer = agent.answer_question(
    question="ç”¨æˆ·é—®é¢˜",
    markdown_content="è®ºæ–‡å†…å®¹", 
    slice_images_dir="åˆ‡ç‰‡å›¾åƒç›®å½•",  # æ”¯æŒè§†è§‰åŠŸèƒ½
    conversation_history=[...]       # å¯¹è¯å†å²
)
```

**æ ¸å¿ƒåŠŸèƒ½**:
- ğŸ¤– **æ™ºèƒ½è·¯ç”±**: è‡ªåŠ¨åˆ¤æ–­é—®é¢˜æ˜¯å¦éœ€è¦è§†è§‰åˆ†æ
- ğŸ‘ï¸ **è§†è§‰é—®ç­”**: åˆ†æå›¾ç‰‡ã€å›¾è¡¨ã€ç¤ºæ„å›¾ç­‰
- ğŸ“ **æ–‡æœ¬é—®ç­”**: åŸºäºè®ºæ–‡æ–‡æœ¬å†…å®¹å›ç­”
- ğŸ¯ **å›¾ç‰‡é€‰æ‹©**: æ ¹æ®é—®é¢˜è‡ªåŠ¨é€‰æ‹©ç›¸å…³å›¾ç‰‡
- ğŸ’¬ **å¯¹è¯å†å²**: æ”¯æŒå¤šè½®å¯¹è¯

## ğŸš€ æ€§èƒ½ä¼˜åŒ–

### å¹¶è¡Œå¤„ç†é…ç½®
- **HTMLè§£æ**: å¹¶è¡Œæ¨¡å¼ï¼Œ10ä¸ªå·¥ä½œçº¿ç¨‹
- **è¾¹ç•Œæ¡†æå–**: 10ä¸ªå·¥ä½œçº¿ç¨‹
- **ä¸´æ—¶æ•°æ®**: ç»Ÿä¸€å­˜å‚¨åœ¨ `/tmp` ç›®å½•

### æ™ºèƒ½é™çº§æœºåˆ¶
```python
# è§†è§‰åˆ†æå¤±è´¥æ—¶è‡ªåŠ¨é™çº§ä¸ºæ–‡æœ¬å›ç­”
try:
    vision_answer = analyze_image(question, image)
except Exception:
    text_answer = analyze_text(question, markdown_content)
    return f"æ— æ³•åˆ†æå›¾ç‰‡ï¼ŒåŸºäºæ–‡æœ¬å›ç­”ï¼š\n{text_answer}"
```

## ğŸ” ä½¿ç”¨ç¤ºä¾‹

### æ–‡æœ¬é—®é¢˜
```
ç”¨æˆ·: "è¿™ç¯‡è®ºæ–‡çš„ä¸»è¦æ–¹æ³•æ˜¯ä»€ä¹ˆï¼Ÿ"
ç³»ç»Ÿ: [è·¯ç”±åˆ¤æ–­: æ–‡æœ¬é—®é¢˜] â†’ [æ–‡æœ¬æ¨¡å‹å›ç­”]
```

### è§†è§‰é—®é¢˜  
```
ç”¨æˆ·: "è®ºæ–‡ä¸­çš„ç¬¬äºŒå¼ å›¾æ˜¾ç¤ºäº†ä»€ä¹ˆï¼Ÿ"
ç³»ç»Ÿ: [è·¯ç”±åˆ¤æ–­: è§†è§‰é—®é¢˜] â†’ [å›¾ç‰‡é€‰æ‹©] â†’ [è§†è§‰æ¨¡å‹åˆ†æ]
```

### å›¾ç‰‡é€‰æ‹©é€»è¾‘
- ğŸ”¢ **åºæ•°è¯†åˆ«**: "ç¬¬äºŒå¼ å›¾" â†’ é€‰æ‹©ç¬¬2å¼ å›¾ç‰‡
- ğŸ”¤ **ä¸­æ–‡æ•°å­—**: "ç¬¬ä¸‰å¹…å›¾" â†’ è½¬æ¢ä¸ºæ•°å­—3
- ğŸ¯ **å…³é”®è¯åŒ¹é…**: "å›¾è¡¨æ•°æ®" â†’ é€‰æ‹©å‰å‡ å¼ ç›¸å…³å›¾ç‰‡

## ğŸ› ï¸ å¼€å‘æŒ‡å—

### æ‰©å±•æ–°çš„Agent
1. åœ¨ `agent/` ç›®å½•ä¸‹åˆ›å»ºæ–°çš„agentæ–‡ä»¶
2. ç»§æ‰¿æˆ–å‚è€ƒç°æœ‰agentçš„ç»“æ„
3. åœ¨ `__init__.py` ä¸­æ³¨å†Œæ–°agent
4. åœ¨ `app.py` ä¸­é›†æˆè°ƒç”¨

### è‡ªå®šä¹‰è·¯ç”±è§„åˆ™
ç¼–è¾‘ `paper_qa_agent.py` ä¸­çš„ `_route_question` æ–¹æ³•ï¼š
```python
def _route_question(self, question: str) -> bool:
    # æ·»åŠ è‡ªå®šä¹‰åˆ¤æ–­é€»è¾‘
    if "æ–°çš„è§†è§‰å…³é”®è¯" in question:
        return True
    return existing_logic(question)
```

## ğŸ“‹ APIæ¥å£

### PaperSummaryAgent
```python
# æ€»ç»“è®ºæ–‡
result = agent.summarize_paper(markdown_file)
# è¿”å›: {'status': 'success', 'summary': '...', 'markdown_content': '...'}

# éªŒè¯æ–‡ä»¶
validation = agent.validate_markdown_content(markdown_file)  
# è¿”å›: {'valid': True, 'message': '...', 'content_length': 1234}
```

### PaperQAAgent
```python
# æ™ºèƒ½é—®ç­”
answer = agent.answer_question(
    question="é—®é¢˜",
    markdown_content="å†…å®¹",
    conversation_history=[],      # å¯é€‰ï¼šå¯¹è¯å†å²
    slice_images_dir="/path"      # å¯é€‰ï¼šå›¾ç‰‡ç›®å½•
)
# è¿”å›: "æ™ºèƒ½å›ç­”å†…å®¹"

# æ‰‹åŠ¨è·¯ç”±åˆ¤æ–­
needs_vision = agent._route_question("é—®é¢˜")
# è¿”å›: True/False
```

## ğŸ”§ é…ç½®è¦æ±‚

### ç¯å¢ƒå˜é‡
```bash
# å¿…é¡»é…ç½®å…¶ä¸­ä¸€ä¸ªAPIå¯†é’¥
export MODELSCOPE_SDK_TOKEN="your_token"
# æˆ–
export DASHSCOPE_API_KEY="your_key"
```

### æ¨¡å‹é…ç½®
- **è·¯ç”±æ¨¡å‹**: Qwen/Qwen3-235B-A22B
- **æ–‡æœ¬æ¨¡å‹**: Qwen/Qwen2.5-14B-Instruct-1M  
- **è§†è§‰æ¨¡å‹**: Qwen/Qwen2.5-VL-72B-Instruct

## ğŸ‰ ä¼˜åŠ¿ç‰¹ç‚¹

### ğŸ§  æ™ºèƒ½åŒ–
- è‡ªåŠ¨åˆ¤æ–­é—®é¢˜ç±»å‹ï¼Œæ— éœ€äººå·¥æŒ‡å®š
- æ™ºèƒ½é€‰æ‹©åˆé€‚çš„æ¨¡å‹è¿›è¡Œå¤„ç†
- è‡ªåŠ¨é™çº§æœºåˆ¶ä¿è¯ç³»ç»Ÿç¨³å®šæ€§

### ğŸ”§ æ¨¡å—åŒ–
- Agentç‹¬ç«‹å¼€å‘å’Œæµ‹è¯•
- ä¾¿äºåŠŸèƒ½æ‰©å±•å’Œç»´æŠ¤
- é™ä½ä»£ç è€¦åˆåº¦

### ğŸš€ é«˜æ€§èƒ½
- å¹¶è¡Œå¤„ç†æé«˜é€Ÿåº¦
- æ™ºèƒ½è·¯ç”±å‡å°‘ä¸å¿…è¦è®¡ç®—
- ä¸´æ—¶æ•°æ®ç»Ÿä¸€ç®¡ç†

### ğŸ’¬ ç”¨æˆ·å‹å¥½
- æ”¯æŒå¤šè½®å¯¹è¯
- è‡ªç„¶è¯­è¨€äº¤äº’
- å›¾æ–‡å¹¶èŒ‚çš„å›ç­”

---

**ğŸ”— ç›¸å…³æ–‡æ¡£**:
- [PDFå·¥ä½œæµæ–‡æ¡£](README_workflow.md)
- [å¸ƒå±€åˆ†ææ–‡æ¡£](README_layout_analyzer.md)
- [ä¸»è¦README](README.md) 